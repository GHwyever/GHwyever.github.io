<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support - DateKeep</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .support-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .support-section h2 {
            color: #4CAF50;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .contact-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .contact-card h3 {
            color: #4CAF50;
            margin-bottom: 10px;
        }
        
        .faq-item {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        
        .faq-item:last-child {
            border-bottom: none;
        }
        
        .faq-question {
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .faq-answer {
            color: #666;
            line-height: 1.6;
        }
        
        .app-info {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #eee;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì¶ DateKeep Support</h1>
            <p>We're here to help you track and manage your items to reduce waste</p>
        </div>

        <div class="support-section">
            <h2>üìû Contact Us</h2>
            <div class="contact-info">
                <div class="contact-card">
                    <h3>üìß Email Support</h3>
                    <p><strong>postmaster@11arts.top</strong></p>
                    <p>Response time: 24-48 hours</p>
                </div>
                <div class="contact-card">
                    <h3>üí¨ In-App Support</h3>
                    <p>Use the "Help" section in the app</p>
                    <p>Settings ‚Üí Help & Support</p>
                </div>
            </div>
        </div>

        <div class="support-section">
            <h2>‚ùì Frequently Asked Questions</h2>
            
            <div class="faq-item">
                <div class="faq-question">How do I add items to track their freshness?</div>
                <div class="faq-answer">
                    Tap the "+" button on the main screen, then either take a photo or manually enter the item details. The app will automatically suggest expiry dates based on the item type and category.
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Can I use the app without creating an account?</div>
                <div class="faq-answer">
                    <p>Yes! DateKeep offers a guest mode that allows you to use all core features without registration. However, creating an account enables cloud sync across devices and backup of your data.</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">How do notifications work?</div>
                <div class="faq-answer">
                    The app sends smart notifications before items expire. You can customize notification timing in Settings ‚Üí Notifications. Choose from 1-7 days before expiry, and enable sound alerts if desired.
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What's included in the Premium subscription?</div>
                <div class="faq-answer">
                    Premium features include: unlimited item tracking, advanced analytics, cloud sync across devices, custom categories, bulk operations, and priority support. Free users can track up to 20 items.
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">How do I cancel my subscription?</div>
                <div class="faq-answer">
                    <p>Go to your device's Settings ‚Üí [Your Name] ‚Üí Subscriptions ‚Üí DateKeep, then tap "Cancel Subscription". You can also manage subscriptions through the App Store.</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">The app is not working properly. What should I do?</div>
                <div class="faq-answer">
                    Try these steps: 1) Force close and restart the app, 2) Restart your device, 3) Check for app updates in the App Store, 4) If issues persist, contact our support team with details about the problem.
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">How do I restore my purchases?</div>
                <div class="faq-answer">
                    Go to Settings ‚Üí Subscription in the app, then tap "Restore Purchases". This will restore any previous Premium subscriptions linked to your Apple ID.
                </div>
            </div>
        </div>

        <div class="support-section">
            <h2>üõ°Ô∏è Privacy & Security</h2>
            <p>Your privacy is important to us. We only collect necessary data to provide our services and never share personal information with third parties. For detailed information, please read our <a href="privacy-policy.html" style="color: #4CAF50;">Privacy Policy</a>.</p>
            
            <div class="app-info">
                <h3>üì± App Information</h3>
                <p><strong>App Name:</strong> DateKeep - Item Expiration Tracker</p>
                <p><strong>Version:</strong> 1.0.0</p>
                <p><strong>Developer:</strong> 11arts Studio</p>
                <p><strong>Compatibility:</strong> iOS 13.0 or later</p>
            </div>
        </div>

        <div class="support-section">
            <h2>üìù Report Issues</h2>
            <p>If you're experiencing issues with DateKeep, please contact our support team. Include details about your device, app version, and the specific issue you're encountering.</p>
            <p>For bugs or suggestions for improvement, please email us at <strong>postmaster@11arts.top</strong> with the following information:</p>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li>Device model and iOS version</li>
                <li>App version</li>
                <li>Detailed description of the issue</li>
                <li>Steps to reproduce the problem</li>
                <li>Screenshots (if applicable)</li>
            </ul>
        </div>

        <div class="footer">
            <p>&copy; 2025 11arts Studio. All rights reserved.</p>
            <p>DateKeep - Reducing waste, one item at a time.</p>
        </div>
</div>

<style>
  .dk-auth-helper{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #e5e7eb;padding:12px 16px;box-shadow:0 -6px 16px rgba(0,0,0,.06);z-index:9999;font-family:system-ui,-apple-system,Segoe UI,Roboto}
  .dk-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
  .dk-title{font-weight:600;color:#111827}
  .dk-sub{font-size:13px;color:#6b7280}
  .dk-btn{appearance:none;border:1px solid #d1d5db;background:#f9fafb;color:#111827;border-radius:10px;padding:8px 12px;font-size:14px}
  .dk-btn.primary{background:#10b981;color:#fff;border-color:#10b981}
  .dk-hidden{display:none}
  @media (prefers-color-scheme: dark){
    .dk-auth-helper{background:#111827;color:#e5e7eb;border-top-color:#374151}
    .dk-btn{background:#1f2937;color:#e5e7eb;border-color:#374151}
    .dk-btn.primary{background:#10b981;color:#fff;border-color:#10b981}
    .dk-title{color:#e5e7eb}
    .dk-sub{color:#9ca3af}
  }
  .dk-container{max-width:800px;margin:0 auto;padding:0 16px}
  .dk-auth-helper .dk-row{justify-content:space-between}
  .dk-actions{display:flex;gap:8px}
</style>
<div id="dk-auth-helper" class="dk-auth-helper dk-hidden">
  <div class="dk-container">
    <div class="dk-row">
      <div>
        <div id="dk-auth-title" class="dk-title">Processing verification‚Ä¶</div>
        <div id="dk-auth-sub" class="dk-sub">Trying to open the app. If it doesn't open, use the buttons below.</div>
      </div>
      <div class="dk-actions">
        <button id="dk-open-app" class="dk-btn primary">Open App</button>
        <button id="dk-copy-link" class="dk-btn">Copy Link</button>
        <button id="dk-open-browser" class="dk-btn">Open in System Browser</button>
      </div>
    </div>
  </div>
  </div>

<script>
(function(){
  const combined = (location.search || '').replace(/^\?/, '') + '&' + (location.hash || '').replace(/^#/, '');
  const qs = new URLSearchParams(combined);
  const type = qs.get('type') || '';
  const tokenHash = qs.get('token_hash') || qs.get('token') || '';
  const email = qs.get('email') || '';
  const redirectTo = qs.get('redirect_to') || '';
  const hasAuthParams = Boolean(type || tokenHash || qs.get('error') || qs.get('error_description') || redirectTo);
  const isWebFallback = qs.get('dk_web') === '1';

  if (!hasAuthParams) return;

  const helper = document.getElementById('dk-auth-helper');
  const titleEl = document.getElementById('dk-auth-title');
  const subEl = document.getElementById('dk-auth-sub');
  const btnOpen = document.getElementById('dk-open-app');
  const btnCopy = document.getElementById('dk-copy-link');
  const btnOpenBrowser = document.getElementById('dk-open-browser');
  helper.classList.remove('dk-hidden');

  const params = new URLSearchParams();
  if (type) params.set('type', type);
  if (tokenHash) params.set('token_hash', tokenHash);
  if (email) params.set('email', email);
  let deeplink = 'freshness://auth-callback?' + params.toString();
  if (/^(freshness|exp\+freshness):\/\//.test(redirectTo || '')) {
    const url = new URL(redirectTo);
    const rp = new URLSearchParams(url.search);
    if (!rp.get('type') && type) rp.set('type', type);
    if (!rp.get('token_hash') && tokenHash) rp.set('token_hash', tokenHash);
    if (!rp.get('email') && email) rp.set('email', email);
    deeplink = `${url.protocol}//${url.host}${url.pathname}?${rp.toString()}`;
  }

  const webFallback = (function(){
    const base = location.origin + location.pathname;
    const p = new URLSearchParams(params);
    p.set('dk_web','1');
    return base + '?' + p.toString();
  })();

  const ua = navigator.userAgent.toLowerCase();
  const isWeChat = /micromessenger/.test(ua);
  const isDingTalk = /dingtalk/.test(ua);
  const isInAppBrowser = isWeChat || isDingTalk || /weibo|alipayclient|qq\//.test(ua);

  if (isInAppBrowser) {
    titleEl.textContent = 'In-app browser detected';
    subEl.textContent = 'Please open with system browser (iOS: Safari / Android: Chrome), or copy the link.';
  } else if (isWebFallback) {
    titleEl.textContent = 'Web fallback';
    subEl.textContent = 'Automatic open failed. Tap ‚ÄúOpen App‚Äù, or copy the link to system browser.';
  } else {
    titleEl.textContent = 'Processing verification';
    subEl.textContent = 'Trying to open the app‚Ä¶ If it does not open, use the buttons below.';
  }

  let navigatedFallback = false;
  function tryOpenApp() {
    const start = Date.now();

    try { window.location.href = deeplink; } catch(_) {}

    setTimeout(() => {
      if (!navigatedFallback && document.visibilityState === 'visible' && Date.now() - start < 1500) {
        navigatedFallback = true;
        window.location.href = webFallback;
      }
    }, 1200);
  }

  async function copyLink() {
    try {
      await navigator.clipboard.writeText(deeplink);
      subEl.textContent = 'Deep link copied. Open with system browser or installed app.';
    } catch(_) {
      subEl.textContent = 'Copy failed. Please copy manually: ' + deeplink;
      alert(deeplink);
    }
  }

  function openInSystemBrowser() {
    try {
      window.open(deeplink, '_blank');
      setTimeout(() => {
        if (document.visibilityState === 'visible') {
          window.open(webFallback, '_blank');
        }
      }, 800);
    } catch(_) {
      window.location.href = webFallback;
    }
  }

  if (!isInAppBrowser && !isWebFallback) {
    tryOpenApp();
  }

  btnOpen.addEventListener('click', tryOpenApp);
  btnCopy.addEventListener('click', copyLink);
  btnOpenBrowser.addEventListener('click', openInSystemBrowser);
})();
</script>
</body>
</html>
